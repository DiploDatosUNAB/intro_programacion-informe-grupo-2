---
title: "Presentes"
author: "Alberto Fernandez y Clara Bonpland Mignaquy"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(presentes)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tidyr)
```

## Introducción

El presente informe consiste en el análisis de los datos del paquete "presentes", el cual reúne la información oficial sobre víctimas de la dictadura militar entre el 24 de marzo de 1976 y el 10 de diciembre de 1983 en Argentina, como también de años previos al inicio formal del golpe de estado militar. 

Las fuentes principales de los datos del paquete provienen de:

Registro Único de Víctimas del Terrorismo de Estado (RUVTE), dependiente de la Secretaría de Derechos Humanos y Pluralismo Cultural del Ministerio de Justicia y Derechos Humanos de la Nación.

https://datos.gob.ar/dataset/justicia-registro-unificado-victimas-terrorismo-estado--ruvte-

Monumento a las Víctimas del Terrorismo de Estado, realizado por el Consejo de Gestión del Parque de la Memoria y del Monumento a las Víctimas del Terrorismo de Estado, creado por la ley 3078 de la Ciudad de Buenos Aires.

http://basededatos.parquedelamemoria.org.ar/


Haremos hincapié en observar las variables que contienen la edad de las víctimas, las ocupaciones y sus espacios de militancia, cuáles fueron las ciudades en las que ocurrieron los secuestros y asesinatos, y en qué años sucedieron.


## Exploración de los datos

En un primer paso, consideramos necesario poder explorar el paquete para conocer qué variables y observaciones contiene.
```{r}
victimas_parque <- presentes::parque_de_la_memoria
victimas_apodo <- presentes::apodos
victimas_denuncia <- presentes::victimas_accionar_represivo_ilegal
victimas_sin_denuncia <- presentes::victimas_accionar_represivo_ilegal_sin_denuncia_formal
centros_clandestinos <- presentes::centros_clandestinos_detencion

```

Selección de variables de victimas_parque:
```{r}
victimas_parque <- select(parque_de_la_memoria, id, edad, fecha_de_secuestro, ano_en_monumento, lugar_de_secuestro, ocupaciones, sexo, militancia)
```

Ahora, exploramos las especificaciones de victimas_parque. Queremos saber qué contiene.
```{r}
victimas_parque %>% 
  glimpse()
```
El dataframe victimas_parque contiene 8.751 observaciones y 8 variables.

Exploración por sexo de las víctimas.
```{r}
victimas_parque %>% 
  group_by(sexo) %>% 
  summarise(cantidad_sexo = n()) %>% 
  arrange(desc(cantidad_sexo)) %>% 
  rename("Víctimas" = cantidad_sexo, "Sexo" = sexo)
```

Exploración por edad de las victimas.
```{r}
victimas_parque %>% 
  filter(edad != "-") %>% 
  group_by(edad) %>% 
  summarise(cantidad = n()) %>% 
  arrange(desc(cantidad)) 
```

Una vez filtrado por edad, nos interesa poder cruzar la cantidad de víctimas por edad y por sexo.

#esto da para graficar
```{r}
victimas_parque %>% 
  filter(edad != "-") %>% 
  group_by(edad, sexo) %>% 
  summarise(cantidad = n()) %>% 
  arrange(desc(cantidad)) %>%
  ggplot(aes(edad, cantidad)) + 
  geom_col(aes(color = sexo)) 
```

Nos interesa incoporar la variable ocupaciones.
```{r}
victimas_parque %>% 
  group_by(ocupaciones) %>% 
  summarise(cant_ocupaciones = n()) %>% 
  arrange(desc(cant_ocupaciones)) %>% 
  rename("Ocupaciones" = ocupaciones, "Víctimas" = cant_ocupaciones)
```

También exploramos por edad y ocupaciones de las víctimas.
```{r}
victimas_parque %>%
  filter(!is.na(ocupaciones)) %>% 
  group_by(ocupaciones, edad) %>% 
  summarise(cantidad = n()) %>% 
  arrange(desc(cantidad))%>% 
  rename("Edad" = edad, "Ocupaciones" = ocupaciones, "Víctimas" = cantidad )
```

Exploramos por ocupación y sexo, filtrando las ocupaciones con cantidad de víctimas mayor a 50.
El motivo de la elección surge de buscar qué ocupaciones eran más relevantes y si estas tienen una relación con la militancia.
```{r}
victimas_parque %>% 
  group_by(ocupaciones,sexo) %>% 
  summarise(cant_ocupaciones = n()) %>% 
  arrange(desc(cant_ocupaciones)) %>% 
  filter(cant_ocupaciones > 50) %>% 
  rename("Ocupaciones" = ocupaciones, "Sexo" = sexo, "Víctimas" = cant_ocupaciones)
```

Ahora procedemos a eliminar todos los datos faltantes (NA) de la tabla.
```{r}
victimas_parque %>% 
  filter(!is.na(ocupaciones)) %>% 
  group_by(ocupaciones,sexo) %>% 
  summarise(cant_ocupaciones = n()) %>% 
  arrange(desc(cant_ocupaciones)) %>% 
  filter(cant_ocupaciones > 50) %>% 
  rename("Ocupaciones" = ocupaciones, "Sexo" = sexo, "Víctimas" = cant_ocupaciones)
```
Queremos saber cuáles fueron los años con mayor cantidad de asesinatos y secuestros.
#acá Elio nos dice "En la documentación de los datos dice que ano_en_documento es el "Año en que se incorpora al monumento del parque" ¿este es el año de la desaparición? ¿Es preciso en todos los casos o quizás en algunos es una estimación? Quizás pueden agregar alguna aclaración sobre de dónde sale este número."
```{r}
victimas_parque %>% 
  group_by(ano_en_monumento) %>% 
  mutate(anio = as.numeric(ano_en_monumento)) %>% 
  group_by(anio) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio)) %>% 
  rename("Año de secuestro/asesinato" = anio, "Víctimas" = victimas_por_anio)
```

Cruzamos la cantidad de víctimas por edad y año de secuestro o asesinato.
```{r}
victimas_parque %>% 
  group_by(ano_en_monumento) %>% 
  mutate(anio = as.numeric(ano_en_monumento)) %>% 
  group_by(edad, anio) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio)) %>% 
  rename("Edad" = edad, "Año de secuestro/asesinato" = anio, "Víctimas" = victimas_por_anio )
```

Buscamos victimas por edad, año de secuestro y ocupación, dejando de lado la variable sexo.
```{r}
victimas_parque %>% 
  group_by(ano_en_monumento) %>% 
  mutate(anio = as.numeric(ano_en_monumento)) %>% 
  group_by(anio, edad, ocupaciones) %>% 
  filter(!is.na(ocupaciones)) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio)) %>% 
  rename("Edad" = edad, "Año de secuestro/asesinato" = anio, "Ocupaciones" = ocupaciones, "Víctimas" = victimas_por_anio)
```

Filtramos víctimas por edad universitaria.
```{r}
victimas_parque %>%
  filter(edad %in% c(19:27)) %>% 
  group_by(edad) %>% 
  summarise(cant_vict_edad = n()) %>% 
  rename("Edad" = edad, "Víctimas" = cant_vict_edad)
  
```

#aca tenemos que elegir si ordenamos por edad o por cantidad de victimas

Ahora ordenamos por cantidad de mayor a menor.
```{r}
victimas_parque %>%
  filter(edad %in% c(19, 20, 21, 22, 23, 24, 25, 26, 27)) %>% 
  group_by(edad) %>% 
  summarise(cant_vict_edad = n()) %>% 
  arrange(desc(cant_vict_edad)) %>% 
  rename("Edad" = edad, "Víctimas" = cant_vict_edad)
```

Nos pareció interesante conocer los espacios de militancia de las víctimas.
```{r}
victimas_parque %>% 
  filter(militancia != "list(listado = character(0))") %>% 
  group_by(militancia = as.character(militancia)) %>% 
  summarise(cant_por_militancia = n()) %>% 
  arrange(desc(cant_por_militancia)) %>% 
  rename("Espacio de militancia" = militancia, "Víctimas" = cant_por_militancia)
```
Exploramos la cantidad de víctimas por espacio de militancia y año.
```{r}
victimas_parque %>% 
  filter(militancia != "list(listado = character(0))") %>% 
  group_by(militancia = as.character(militancia), ano_en_monumento) %>% 
  summarise(cant_por_militancia = n()) %>% 
  arrange(desc(cant_por_militancia)) %>% 
  rename("Espacio de militancia" = militancia, "Víctimas" = cant_por_militancia, "Año de secuestro o detención" = ano_en_monumento)
```

Cruzamos la cantidad de víctimas por espacios de militancia y sus ocupaciones.
```{r}
victimas_parque %>% 
  filter(militancia != "list(listado = character(0))") %>% 
  group_by(militancia = as.character(militancia), ocupaciones) %>% 
  summarise(cant_por_militancia = n()) %>% 
  arrange(desc(cant_por_militancia))%>% 
  rename("Espacio de militancia" = militancia, "Víctimas" = cant_por_militancia, "Ocupaciones" = ocupaciones)
```
Teniendo en cuenta que hay datos faltantes de ocupaciones de las víctimas, dejamos de lado los NA.
```{r}
victimas_parque %>% 
  filter(militancia != "list(listado = character(0))", !is.na(ocupaciones)) %>%
  group_by(militancia = as.character(militancia), ocupaciones) %>% 
  summarise(cant_por_militancia = n()) %>% 
  arrange(desc(cant_por_militancia)) %>% 
  rename("Espacio de militancia" = militancia, "Víctimas" = cant_por_militancia, "Ocupaciones" = ocupaciones)
```

También queremos conocer los lugares en que ocurrieron los secuestros o detenciones de las víctimas.
```{r}
victimas_parque %>% 
  filter(!is.na(lugar_de_secuestro)) %>% 
  group_by(lugar_de_secuestro) %>%
  summarise(cantidad_lugar = n()) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  rename("Lugar de secuestro" = lugar_de_secuestro, "Víctimas" = cantidad_lugar)
```

Cruzamos los lugares de secuestro con las ocupaciones y la edad de las víctimas.
```{r}
victimas_parque %>% 
  filter(!is.na(lugar_de_secuestro)) %>% 
  group_by(lugar_de_secuestro, ocupaciones, edad) %>%
  summarise(cantidad_lugar = n()) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  rename("Lugar de secuestro" = lugar_de_secuestro, "Ocupaciones" = ocupaciones, "Edad" = edad, "Víctimas" = cantidad_lugar)
```

Resulta interesante que la ciudad de Mar de Plata se encuentra en 6° lugar de la tabla, por lo que buscamos las ocupaciones de las víctimas en el lugar.
#Estaría bueno aclarar por qué consideran sorprentende ver a Mar del Plata en el 6to lugar. ¿Es porque es una ciudad relativamente chica? (San Miguel de Tucumán tiene actualmente una población similar a Mar del Plata y aparece 4ta. aunque una comparación más correcta sería con la población de esa época.)

```{r}
victimas_parque %>% 
  filter(!is.na(lugar_de_secuestro)) %>% 
  group_by(lugar_de_secuestro, ocupaciones) %>%
  filter(lugar_de_secuestro == "MAR DEL PLATA. BS. AS.") %>% 
  summarise(cantidad_lugar = n()) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  rename("Lugar de secuestro" = lugar_de_secuestro, "Ocupaciones" = ocupaciones, "Víctimas" = cantidad_lugar)
```
Como el resto de las ciudades son universitarias, decidimos filtrar por espacios de militancia.
```{r}
victimas_parque %>% 
  filter(!is.na(lugar_de_secuestro)) %>% 
  group_by(lugar_de_secuestro, militancia = as.character(militancia)) %>%
  filter(lugar_de_secuestro == "MAR DEL PLATA. BS. AS.") %>% 
  summarise(cantidad_lugar = n()) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  rename("Lugar de secuestro" = lugar_de_secuestro, "Víctimas" = cantidad_lugar, "Espacio de miitancia" = militancia)
```

Para profundizar el análisis, decidimos incorporar el dataframe victimas_denuncia.

Selección de variables:
```{r}
victimas_denuncia <- select(victimas_accionar_represivo_ilegal, id_unico_ruvte, fecha_detencion_secuestro, lugar_detencion_secuestro, provincia_nacimiento, tipificacion_ruvte, edad_al_momento_del_hecho_numerico)
```
Ahora, exploramos las especificaciones de victimas_denuncia. Queremos saber qué contiene.
```{r}
victimas_denuncia %>% 
  glimpse()
```
El dataframe victimas_denuncia contiene 8.753 observaciones y 6 variables.

Exploración por edad. A diferencia del dataframe con el que trabajamos anteriormente, en este los años son de tipo numérico.
```{r}
victimas_denuncia %>% 
  group_by(edad_al_momento_del_hecho_numerico) %>% 
  summarise(cantidad = n()) %>% 
  arrange(desc(cantidad)) %>% 
  rename("Edad" = edad_al_momento_del_hecho_numerico, "Víctimas" = cantidad)
```
Buscamos el promedio, el valor máximo, el valor mínimo y el desvío estándar de la edad.
```{r}
victimas_denuncia %>% 
  summarise(edad_max = max(edad_al_momento_del_hecho_numerico, na.rm = TRUE), 
            edad_min = min(edad_al_momento_del_hecho_numerico, na.rm = TRUE), 
            edad_media = mean(edad_al_momento_del_hecho_numerico, na.rm = TRUE),
            edad_sd = sd(edad_al_momento_del_hecho_numerico, na.rm = TRUE)) %>% 
  rename("Edad máxima" = edad_max, 
         "Edad mínima" = edad_min, 
         "Edad media" = edad_media, 
         "Desviación estándar" = edad_sd)
```

Exploramos lugar de secuestro, dejando de lado los datos faltantes(na).
```{r}
victimas_denuncia %>% 
  filter(!is.na(lugar_detencion_secuestro)) %>% 
  group_by(lugar_detencion_secuestro) %>% 
  summarise(cantidad_lugar = n()) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  rename("Lugar de detención o secuestro" = lugar_detencion_secuestro, "Víctimas" = cantidad_lugar)
```

Filtramos los lugares de secuestro de más de 100 victimas.
#¿Por qué esta decisión?
Albe, para mi la decisión tiene que ver con encontrar patrones, en qué coinciden los datos, o qué ciudades tuvieron máyor número de víctimas y qué relación tiene esa cantidad con otras variables...  Creo que el 100 fue elegido al azar por los dos, en todo caso la pregunta puede derivar a buscar si qué pasa con los lugares con menos victimas... o dejar de filtrar por 100
```{r}
victimas_denuncia %>% 
  filter(!is.na(lugar_detencion_secuestro)) %>% 
  group_by(lugar_detencion_secuestro) %>% 
  summarise(cantidad_lugar = n()) %>% 
  filter(cantidad_lugar > 100) %>% 
  arrange(desc(cantidad_lugar)) %>% 
  ggplot(aes(lugar_detencion_secuestro, cantidad_lugar)) + 
  geom_col()
```

Contamos la cantidad de victimas cuyo lugar de detención no está determinado.
```{r}
victimas_denuncia %>% 
  summarise(cantidad_nas_lugar_secuestro = sum(is.na(lugar_detencion_secuestro))) %>% 
  rename("Cantidad de víctimas sin lugar de detención o secuestro determinado" = cantidad_nas_lugar_secuestro)
```

## Hipótesis

Es necesario mencionar una cuestión muy importante sobre este trabajo, y es que, más allá de que los datos recabados indican un número de 8753 víctimas, existe una gran cantidad de víctimas desaparecidas que aún no han sido encontradas y cuya búsqueda continúa hasta el día de hoy.

En el presente trabajo intentaremos responder, estableciendo las relaciones entre distintas variables, a las preguntas que han surgido luego de explorar los datasets.

Durante los primeros años del golpe de Estado cívico-militar, observamos que la mayor cantidad de secuestros y/o asesinatos de víctimas ocurrieron entre los años 1976 y 1977, y el rango etario predominante de las víctimas fue de 17 a 30 años, en su mayoría estudiantes. Esto nos hace reflexionar si la edad universitaria fue un factor a la hora de convertirse en posibles víctimas. También nos preguntamos cómo varió la edad y ocupación de las víctimas entre los años 1978 y 1982. Si disminuyó el número de secuestros y/o asesinatos, pensar en posibles respuestas que indiquen esta característica.

```{r}
victimas_parque %>%
  group_by(fecha_de_secuestro) %>% 
  mutate(fecha = dmy(fecha_de_secuestro)) %>% 
  mutate(anio = year(fecha)) %>% 
  group_by(anio, edad, ocupaciones) %>% 
  filter(!is.na(anio) & !is.na(ocupaciones)) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio))
```

Creamos dataset de  las victimas por año de secuestro, con ocupacion Estuadiante desde el 1971 al 1983:
```{r}
est_83_71 <- victimas_parque %>%
  group_by(fecha_de_secuestro) %>% 
  mutate(fecha = dmy(fecha_de_secuestro)) %>% 
  mutate(anio = year(fecha)) %>% 
  group_by(anio, ocupaciones) %>% 
  filter(!is.na(anio), ocupaciones %in% c("Estudiante Universitario", "Estudiante Universitaria", "Estudiante", "Estudiante Secundario")) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio)) 
  
```
Graficamos lo anterior
```{r}
est_83_71 %>% 
  ggplot(aes(anio, victimas_por_anio)) +
  geom_line(aes(color = ocupaciones))
```

Creo dataset de victimas por edad y ocupacion entre 1978 y 1982
```{r}
victimas_78_82 <- victimas_parque %>%
  group_by(fecha_de_secuestro) %>% 
  mutate(fecha = dmy(fecha_de_secuestro)) %>% 
  mutate(anio = year(fecha)) %>% 
  group_by(anio, ocupaciones, edad) %>% 
  filter(anio %in% c(1978:1982)) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(anio)) 
  
```
Filtro Victimas del 78 al 82, agrupando por su edad y año.
```{r}
victimas_78_82 %>% 
  filter(!is.na(ocupaciones) & edad > 0) %>% 
  group_by(edad, anio) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio))
```

Gráfico de lo anterior, podemos ver otra manera para que quede mejor
```{r}
victimas_78_82 %>% 
  filter(edad > 0) %>% 
  group_by(edad, anio) %>% 
  summarise(victimas_por_anio = n()) %>% 
  ggplot(aes(anio, victimas_por_anio)) + 
  geom_jitter(aes(color = edad))
```
También nos preguntamos cómo varió la edad y ocupación de las víctimas entre los años 1978 y 1982. Si disminuyó el número de secuestros y/o asesinatos, pensar en posibles respuestas que indiquen esta característica.


la edad fue un factor determinante? podemos buscar otras maneras de graficarlo
```{r}
victimas_78_82 %>% 
  filter(edad > 0 & victimas_por_anio > 0) %>% 
  ggplot(aes(anio, victimas_por_anio)) + 
  geom_col(aes(color = edad))
```

como vario la edad y ocupacion de victimas entre 1978 y 1982. disminutyó el numero de hechos? todavia no lo logré
```{r}
victimas_78_82 %>% 
  filter(edad > 0 & edad != "-") %>%
  group_by(edad,anio) %>% 
  summarise(cantidad_edad = n()) %>% 
  ggplot(aes(anio, cantidad_edad)) + 
  geom_line(aes(color = edad))
```
```{r}

```


Las primeras cinco ciudades con más desaparecidos son Capital Federal, Córdoba Capital, La Plata, San Miguel de Tucumán, Rosario y, en un sexto lugar y con más de 200 casos, aparece Mar del Plata. Esto resulta, como mínimo, interesante ya que Mar del Plata no se presenta como una ciudad universitaria. ¿La variable estudiantes explica también los casos ocurridos en las otras cinco ciudades? Debemos incorporar otras categorías al análisis, como son los espacios de militancia. ¿Cuál es la proporción de militantes cuyas ocupaciones están vinculadas a estudios y cuál vinculadas a la actividad sindical? Y establecer relaciones entre estas variables y los lugares de secuestro y/o asesinato de las víctimas.

```{r}

```



Dicho lo anterior, nuestra hipótesis se pregunta cuál fue la variable identitaria que más se repite en las víctimas y cuál es su relación con el lugar del hecho y el año en que ocurrieron.

variable identitaria más repetida y su relación con el lugar del hecho y el año en que ocurrieron
```{r}

```


DESARMANDO LA TABLA DE MILITANCIA
```{r}
militancias <- victimas_parque %>% 
  tidyr::unnest(militancia) %>% 
  select(id, ocupaciones, lugar_de_secuestro, listado)

militancias


```

```{r}
militancias %>% 
  group_by(id) %>% 
  summarise(cantidad = n()) %>% 
  filter(cantidad == 1)
  
```

victimas con dos espacios de militancia
```{r}
militancias %>% 
  group_by(id, ocupaciones) %>% 
  summarise(cantidad = n()) %>% 
  filter(cantidad == 2)
  
```
```{r}
militancias %>% 
  group_by(id) %>% 
  summarise(cantidad = n()) %>% 
  filter(cantidad == 3)
  
```
```{r}
militancias %>% 
  group_by(id, ocupaciones) %>% 
  summarise(cantidad = n()) %>% 
  filter(cantidad == 4) 
  
  
```

probando codigo para comprara cantidad de victimas por años
```{r}
anio_real <- victimas_parque %>%
  group_by(fecha_de_secuestro) %>% 
  mutate(fecha = dmy(fecha_de_secuestro)) %>% 
  mutate(anio = year(fecha)) %>% 
  group_by(anio) %>% 
  filter(!is.na(anio)) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio))
```

```{r}
anio_monumento <- victimas_parque %>% 
  group_by(ano_en_monumento) %>% 
  mutate(anio = as.numeric(ano_en_monumento)) %>% 
  group_by(anio) %>% 
  summarise(victimas_por_anio = n()) %>% 
  arrange(desc(victimas_por_anio)) 
```
Comparación de cantidad de victimas por año con fecha de secuestro y por año con anio en monumeto
```{r}
anio_real %>% 
  left_join(anio_monumento, by = "anio", suffix = c(".anio", ".anio_en_monumento")) 
```

